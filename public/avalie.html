<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>página</title>
</head>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    min-height: 100vh;
    display: flex;
    font-family: 'Inter', sans-serif;
    background-color: #F1F0F5;
}
.sidebar {
    background-color: #c6cbe6;
    width: 254px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.7);
}

.sidebar .perfil {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 52px 52px 0 52px;
}
.sidebar a:focus {
    outline: none;
}

.perfil a {
    background-color: #6C802A;
    border-radius: 100px;
    font-size: 17px;
    font-weight: 600;
    padding: 6px 48px;
    color: #fff;
    margin-top: 16px;
    transition: .2s ease-in-out;
    box-shadow: 0 2px 16px rgba(0, 0, 0, 0.12);
}

.sidebar .navbar {
    width: 100%;
    margin-top: 44px;
}
.sidebar .navbar ul li a {
    display: block;
    color: #251A09;
    font-size: 16px;
    font-weight: 500;
    padding: 35px;
    transition: .2s ease-in-out;
}


.sidebar .navbar ul li a.selecionado {
    background-color: #ffffff;
}

.sidebar button {
    background-color: #CE1413;
    color: #fff;
    border-radius: 8px;
    padding: 8px 48px;
    font-size: 17px;
    border: none;
    font-weight: 600;
    margin-bottom: 61px;
    cursor: pointer;
    transition: .2s ease-in-out;
}

.sidebar button:hover {
    background-color: #ad1010;

}

main {
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
}
.dashboard-container {
    width: 100%;
    background-color: #fff;
    padding: 13px;
    box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);
    border-radius: 8px;
    align-items: center;
}

.box {
 
   color: #000000;
 
   margin-top: 90px;
   font-weight: bold;
   margin-left: 200px ;
    width: 45%;
    height: 40%;
    flex-direction: center;
    justify-content: center;
}  


</style>
<body>

    

<nav class="sidebar">
    <div>

 

    </div>
    
    </div>
    <div class="navbar">
        <ul>
              <li><a class="selecionado" href="avalie.html">Avalie o anime</a></li>
            <li><a href="logado.html">Gráficos</a></li>
            <li><a href="quizz.html">Quizz</a></li>
        </ul>
    </div>
    </div>
    <button onclick="window.location.href='index.html'" onclick="sair()">Sair</button>
</nav>

<div class="box">
<h2>Você gostou de assistir o anime Demon Slayer - Kimetsu no Yaiba?</h2>
<input type="radio"  name="nome_do_grupo" value="Sim" id="sim">
<label for="id1">Sim</label>
<input type="radio"  name="nome_do_grupo" value="Não" id="nao">
<label for="id2">Não</label><br><br><br><br>
<form>
  <label for="mensagem">Deixe um comentário:</label><br>
  <textarea id="comentario" name="mensagem" rows="10" cols="50" placeholder="Escreva aqui..."></textarea><br></form>
  <button type="button" onclick="publicar()">Enviar</button>

</div>
</body>
</html>
<script>
  function publicar() {
    var idUsuario = sessionStorage.ID_USUARIO;
    if (!idUsuario) {
      alert("Usuário não identificado");
      return;
    }

    var descricao = document.getElementById("comentario").value;

 
    var respostaSelecionada = document.querySelector('input[name="nome_do_grupo"]:checked');
    console.log("respostaSelecionada:", respostaSelecionada);
console.log("respostaSelecionada.value (antes de converter):", respostaSelecionada ? respostaSelecionada.value : null);
    if (!respostaSelecionada) {
      alert("Escolha Sim ou Não!");
      return;
    }

    var resposta = (respostaSelecionada.value === "Sim") ? 1 : 0;

    console.log("ID usuario:", idUsuario);
    console.log("Comentário:", descricao);
    console.log("Resposta (Sim=1 / Não=0):", resposta);

    fetch(`/dash/publicar/${idUsuario}`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        gostou_anime: resposta,
        comentario: descricao
      })
    })
    .then(res => res.text())
    .then(txt => {

      document.getElementById("comentario").value = "";
      respostaSelecionada.checked = false;
    })
    .catch(err => console.error("ERRO no fetch:", err));
  }

  
  window.publicar = publicar;
</script>
